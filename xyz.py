import base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9weXRob24yDQojLSotY29kaW5nOnV0Zi04LSotDQojQ3JlYXRlZCBCeSBNYXJrIENvcm5lbA0KI1RoYW5rcyBUbyBNeSBUZWFjaGVyIFdobyBIYXMgUGVyZmVjdGVkIFRoaXMgU2NyaXB0IChBbmdnYSBLdXJuaWF3YW4gJiBNdWggUml6YWwgRmlhbnN5YWgpDQojTHUgTWF1IFJlY29kZSwgTWF1IEx1IEFwYWluIFRlcnNlcmFoIEJybywgVGFwaSBIYXJnYWkgTGFoIEthcnlhIEd1YS4NCiNHdyBCaWtpbiBOaSBTQyBTdXNhaCBQYXlhaCwgTmdlcmFraXQgU2FuYSBTaW5pIEJhbnlhayBFcnJvciwgSmduIFNlZW5ha255YSBHYW50aSBOYW1hIEF1dGhvciwgQXBhbGFnaSBOZ2FsaWhpbiBCb3RueWEuIFRlcmltYSBLYXNpaC4NCg0KaW1wb3J0IHJlcXVlc3RzLGJzNCxzeXMsb3Msc3VicHJvY2Vzcyx1dWlkDQppbXBvcnQgcmVxdWVzdHMsc3lzLHJhbmRvbSx0aW1lLHJlLGJhc2U2NCxqc29uDQppbXBvcnQgb3MsIHJlLCByZXF1ZXN0cywgY29uY3VycmVudC5mdXR1cmVzDQpmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludA0KZnJvbSBjb25jdXJyZW50LmZ1dHVyZXMgaW1wb3J0IFRocmVhZFBvb2xFeGVjdXRvciBhcyBUaHJlYWRQb29sDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQ0KY3VycmVudCA9IGRhdGV0aW1lLm5vdygpDQoNCnAgPSAiXHgxYlswOzM3bSIgIyBwdXRpaA0KbSA9ICJceDFiWzA7MzFtIiAjIG1lcmFoDQpoID0gIlx4MWJbMDszMm0iICMgaGlqYXUNCmsgPSAiXHgxYlswOzMzbSIgIyBrdW5pbmcNCmIgPSAiXHgxYlswOzM0bSIgIyBiaXJ1DQp1ID0gIlx4MWJbMDszNW0iICMgdW5ndQ0KbyA9ICJceDFiWzA7MzZtIiAjIGJpcnUgbXVkYQ0KDQppZiAoImxpbnV4IiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKSk6DQoNCiAgICAgICAgTiA9ICJcMDMzWzBtIg0KICAgICAgICBHID0gIlwwMzNbMTs5Mm0iDQogICAgICAgIE8gPSAiXDAzM1sxOzk3bSINCiAgICAgICAgUiA9ICJcMDMzWzE7OTFtIg0KZWxzZToNCg0KICAgICAgICBOID0gIiINCiAgICAgICAgRyA9ICIiDQogICAgICAgIE8gPSAiIg0KICAgICAgICBSID0gIiINCg0KIyMjIEhFQURFUlMgIyMjDQoNCmRlZiBiYW5uZXIoKToNCiAgICBwcmludCgiIiIgICBfX18gICAgICAgICAgICAgICAgICAgXG4gIC8gXyBcX19fX19fXyAgICAgICAgICAgICDCriBcbiAvIF9fXy8gX18vIC1fKSBNdWx0aSBCcnV0ZSAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4vXy8gIC9fL19fXF9fLyhfKSBceDFiWzA7MzZtRm9yY2UgMi4wXHgxYlswOzM0bSAg4pSCICBTY3JpcHQgQnkgXHgxYlswOzMxbU1hcmsgQ29ybmVsXHgxYlswOzM0bSDilIJcbiAgICAgICAvICBeIFwvIC8gLy8gLyAgXiBcICAg4pSCXHgxYlswOzMxbUdpdGh1Yi5jb20vR1VQVEEtU0hBS0VMIFx4MWJbMDszNG3ilIJcbiAgICAgIC9fL18vXy9fL1xfLF8vXy9fL18vICAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYIiIiKQ0KICAgIA0KaG9zdD0iaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tIg0KdWE9Ik1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgTWkgOVQgUHJvIEJ1aWxkL1FLUTEuMTkwODI1LjAwMjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS84OC4wLjQzMjQuMTgxIE1vYmlsZSBTYWZhcmkvNTM3LjM2W0ZCQU4vRU1BO0ZCTEMvaXRfSVQ7RkJBVi8yMzkuMC4wLjEwLjEwOTtdIg0KdWFzPSJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IE1pIDlUIFBybyBCdWlsZC9RS1ExLjE5MDgyNS4wMDI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODguMC40MzI0LjE4MSBNb2JpbGUgU2FmYXJpLzUzNy4zNltGQkFOL0VNQTtGQkxDL2l0X0lUO0ZCQVYvMjM5LjAuMC4xMC4xMDk7XSINCmlwcz1Ob25lDQp0cnk6DQoJYj1yZXF1ZXN0cy5nZXQoImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZyIpLnRleHQuc3RyaXAoKQ0KCWlwcz1yZXF1ZXN0cy5nZXQoImh0dHBzOi8vaXBhcGkuY29tL2lwX2FwaS5waHA/aXA9IitiLGhlYWRlcnM9eyJSZWZlcmVyIjoiaHR0cHM6Ly9pcC1hcGkuY29tLyIsIkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLCJVc2VyLUFnZW50IjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzkwLjAuNDQzMC45MyBTYWZhcmkvNTM3LjM2In0pLmpzb24oKVsiY291bnRyeV9uYW1lIl0ubG93ZXIoKQ0KZXhjZXB0Og0KCWlwcz1Ob25lDQoNCm1iYXNpY19oPXsiSG9zdCI6Im1iYXNpYy5mYWNlYm9vay5jb20iLCJjYWNoZS1jb250cm9sIjoibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6IjEiLCJ1c2VyLWFnZW50IjoiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBNaSA5VCBQcm8gQnVpbGQvUUtRMS4xOTA4MjUuMDAyOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzg4LjAuNDMyNC4xODEgTW9iaWxlIFNhZmFyaS81MzcuMzZbRkJBTi9FTUE7RkJMQy9pdF9JVDtGQkFWLzIzOS4wLjAuMTAuMTA5O10iLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43In0NCmZfZmJoPXsiSG9zdCI6ImZyZWUuZmFjZWJvb2suY29tIiwiY2FjaGUtY29udHJvbCI6Im1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiIxIiwidXNlci1hZ2VudCI6Ik1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgTWkgOVQgUHJvIEJ1aWxkL1FLUTEuMTkwODI1LjAwMjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS84OC4wLjQzMjQuMTgxIE1vYmlsZSBTYWZhcmkvNTM3LjM2W0ZCQU4vRU1BO0ZCTEMvaXRfSVQ7RkJBVi8yMzkuMC4wLjEwLjEwOTtdIiwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJpZC1JRCxpZDtxPTAuOSxlbi1VUztxPTAuOCxlbjtxPTAuNyJ9DQpvayA9IFtdDQpjcCA9IFtdDQp0dGwgPVtdDQoNCmR1cmFzaSA9IHN0cihkYXRldGltZS5ub3coKS5zdHJmdGltZSgiJWQtJW0tJVkiKSkNCnRhaHVuID0gY3VycmVudC55ZWFyDQpidWxhbiA9IGN1cnJlbnQubW9udGgNCmhhcmkgPSBjdXJyZW50LmRheQ0KDQpkZWYgamFsYW4oeik6DQoJZm9yIGUgaW4geiArICJcbiI6DQoJCXN5cy5zdGRvdXQud3JpdGUoZSkNCgkJc3lzLnN0ZG91dC5mbHVzaCgpDQoJCXRpbWUuc2xlZXAoMC4wMykNCg0KZGVmIGNsZWFyKCk6DQoJaWYgIiBsaW51eCIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6DQoJCW9zLnN5c3RlbSgiY2xlYXIiKQ0KCWVsaWYgIndpbiIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6DQoJCW9zLnN5c3RlbSgiY2xzIikNCgllbHNlOm9zLnN5c3RlbSgiY2xlYXIiKQ0KICAgIA0KZGVmIGxhbmcoY29va2llcyk6DQoJZj1GYWxzZQ0KCXJyPWJzNC5CZWF1dGlmdWxTb3VwKHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xhbmd1YWdlLnBocCIsaGVhZGVycz1oZGNvaygpLGNvb2tpZXM9Y29va2llcykudGV4dCwiaHRtbC5wYXJzZXIiKQ0KCWZvciBpIGluIHJyLmZpbmRfYWxsKCJhIixocmVmPVRydWUpOg0KCQlpZiAiaWRfSUQiIGluIGkuZ2V0KCJocmVmIik6DQoJCQlyZXF1ZXN0cy5nZXQoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iK2kuZ2V0KCJocmVmIiksY29va2llcz1jb29raWVzLGhlYWRlcnM9aGRjb2soKSkNCgkJCWI9cmVxdWVzdHMuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vcHJvZmlsZS5waHAiLGhlYWRlcnM9aGRjb2soKSxjb29raWVzPWNvb2tpZXMpLnRleHQJDQoJCQlpZiAiYXBhIHlhbmcgYW5kYSBwaWtpcmthbiBzZWthcmFuZyIgaW4gYi5sb3dlcigpOg0KCQkJCWY9VHJ1ZQ0KCWlmIGY9PVRydWU6DQoJCXJldHVybiBUcnVlDQoJZWxzZToNCgkJZXhpdCgiWyFdIFdyb25nIENvb2tpZXMiKQ0KDQpkZWYgYmFzZWNvb2tpZSgpOg0KCWlmIG9zLnBhdGguZXhpc3RzKCIuY29rIik6DQoJCWlmIG9zLnBhdGguZ2V0c2l6ZSgiLmNvayIpICE9MDoNCgkJCXJldHVybiBnZXRzX2RpY3RfY29va2llcyhvcGVuKCcuY29rJykucmVhZCgpLnN0cmlwKCkpDQoJCWVsc2U6bG9ncygpDQoJZWxzZTpsb2dzKCkNCg0KZGVmIGhkY29rKCk6DQoJZ2xvYmFsIGhvc3QsdWENCglob3N0cz1ob3N0DQoJcj17Im9yaWdpbiI6IGhvc3RzLCAiYWNjZXB0LWxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwgImFjY2VwdC1lbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwgInVzZXItYWdlbnQiOiB1YSwgIkhvc3QiOiAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCI6Ly8oLio/KSQiLGhvc3RzKSksICJyZWZlcmVyIjogaG9zdHMrIi9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCAiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLCAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifQ0KCXJldHVybiByDQoNCmRlZiBnZXRzX2Nvb2tpZXMoY29va2llcyk6DQoJcmVzdWx0PVtdDQoJZm9yIGkgaW4gZW51bWVyYXRlKGNvb2tpZXMua2V5cygpKToNCgkJaWYgaVswXT09bGVuKGxpc3QoY29va2llcy5rZXlzKCkpKS0xOnJlc3VsdC5hcHBlbmQoaVsxXSsiPSIrY29va2llc1tpWzFdXSkNCgkJZWxzZTpyZXN1bHQuYXBwZW5kKGlbMV0rIj0iK2Nvb2tpZXNbaVsxXV0rIjsgIikNCglyZXR1cm4gIiIuam9pbihyZXN1bHQpDQoNCmRlZiBnZXRzX2RpY3RfY29va2llcyhjb29raWVzKToNCglyZXN1bHQ9e30NCgl0cnk6DQoJCWZvciBpIGluIGNvb2tpZXMuc3BsaXQoIjsiKToNCgkJCXJlc3VsdC51cGRhdGUoe2kuc3BsaXQoIj0iKVswXTppLnNwbGl0KCI9IilbMV19KQ0KCQlyZXR1cm4gcmVzdWx0DQoJZXhjZXB0Og0KCQlmb3IgaSBpbiBjb29raWVzLnNwbGl0KCI7ICIpOg0KCQkJcmVzdWx0LnVwZGF0ZSh7aS5zcGxpdCgiPSIpWzBdOmkuc3BsaXQoIj0iKVsxXX0pDQoJCXJldHVybiByZXN1bHQNCg0KIyMjIExPR0lOIE1FVEhPREUgIyMjDQoNCmRlZiBsb2dzKCk6DQogIG9zLnN5c3RlbSgiY2xlYXIiKQ0KICBiYW5uZXIoKQ0KICBwcmludCgoaysiXG5bIitwKyIxIitrKyJdIitwKyIgTG9naW4gVG9rZW4iKSkNCiAgcHJpbnQoKGsrIlsiK3ArIjIiK2srIl0iK3ArIiBMb2dpbiBDb29raWVzIikpDQogIHByaW50KChrKyJbIitwKyIzIitrKyJdIitwKyIgVXBkYXRlIFNjcmlwdCIpKQ0KICBwcmludCgoaysiWyIrcCsiNCIraysiXSIrcCsiIFJlcG9ydCBCdWciKSkNCiAgcHJpbnQoKGsrIlsiK3ArIjAiK2srIl0iK3ArIiBFeGl0IikpDQogIHNlaz1pbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpDQogIGlmIHNlaz09IiI6DQogICAgcHJpbnQoKGsrIlxuWyIrcCsiISIraysiXSIrcCsiIEZpbGwgSW4gVGhlIENvcnJlY3QiKSkNCiAgICBsb2dzKCkNCiAgZWxpZiBzZWs9PSIxIjoNCiAgICBsb2dfdG9rZW4oKQ0KICBlbGlmIHNlaz09IjIiOg0KICAgIGdlbigpDQogIGVsaWYgc2VrPT0iMyI6DQogICAgdXBkYXRlc2MoKQ0KICBlbGlmIHNlaz09IjQiOg0KICAgIHdhbmdzYWZmKCkNCiAgZWxpZiBzZWs9PSIwIjoNCiAgICBleGl0KCkNCiAgZWxzZToNCiAgICBwcmludCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQ0KICAgIGxvZ3MoKQ0KDQpkZWYgbG9nX3Rva2VuKCk6DQogICAgb3Muc3lzdGVtKCJjbGVhciIpDQogICAgYmFubmVyKCkNCiAgICB0b2tldCA9IGlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVG9rZW4gOiAiKQ0KICAgIHRyeToNCiAgICAgICAgb3R3ID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2V0KQ0KICAgICAgICBhID0ganNvbi5sb2FkcyhvdHcudGV4dCkNCiAgICAgICAgbmFtYSA9IGFbIm5hbWUiXQ0KICAgICAgICB6ZWRkID0gb3BlbigibG9naW4udHh0IiwgInciKQ0KICAgICAgICB6ZWRkLndyaXRlKHRva2V0KQ0KICAgICAgICB6ZWRkLmNsb3NlKCkNCiAgICAgICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgTG9naW4gU3VjY2Vzc2Z1bCIpKQ0KICAgICAgICBib3RfZm9sbG93KCkNCiAgICBleGNlcHQgS2V5RXJyb3I6DQogICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgVG9rZW4gSW52YWxpZCIpKQ0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICAgICAgbG9ncygpDQoNCmRlZiBnZW4oKToNCiAgICAgICAgb3Muc3lzdGVtKCJjbGVhciIpDQogICAgICAgIGJhbm5lcigpDQogICAgICAgIGNvb2tpZSA9IGlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ29va2llcyA6ICIpDQogICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBkYXRhID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tL2NvbXBvc2VyL29jZWxvdC9hc3luY19sb2FkZXIvP3B1Ymxpc2hlcj1mZWVkI189XyIsIGhlYWRlcnMgPSB7DQogICAgICAgICAgICAgICAgInVzZXItYWdlbnQiICAgICAgICAgICAgICAgIDogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA4LjEuMDsgTUkgOCBCdWlsZC9PUE0xLjE3MTAxOS4wMTEpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS82OS4wLjM0OTcuODYgTW9iaWxlIFNhZmFyaS81MzcuMzYiLCAjIEphbmdhbiBEaSBHYW50aSBFYSBBbmppbmsuDQogICAgICAgICAgICAgICAgInJlZmVyZXIiICAgICAgICAgICAgICAgICAgIDogImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIiwNCiAgICAgICAgICAgICAgICAiaG9zdCIgICAgICAgICAgICAgICAgICAgICAgOiAibS5mYWNlYm9vay5jb20iLA0KICAgICAgICAgICAgICAgICJvcmlnaW4iICAgICAgICAgICAgICAgICAgICA6ICJodHRwczovL20uZmFjZWJvb2suY29tIiwNCiAgICAgICAgICAgICAgICAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyIgOiAiMSIsDQogICAgICAgICAgICAgICAgImFjY2VwdC1sYW5ndWFnZSIgICAgICAgICAgIDogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwNCiAgICAgICAgICAgICAgICAiY2FjaGUtY29udHJvbCIgICAgICAgICAgICAgOiAibWF4LWFnZT0wIiwNCiAgICAgICAgICAgICAgICAiYWNjZXB0IiAgICAgICAgICAgICAgICAgICAgOiAidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsDQogICAgICAgICAgICAgICAgImNvbnRlbnQtdHlwZSIgICAgICAgICAgICAgIDogInRleHQvaHRtbDsgY2hhcnNldD11dGYtOCINCiAgICAgICAgICAgICAgICB9LCBjb29raWVzID0gew0KICAgICAgICAgICAgICAgICJjb29raWUiICAgICAgICAgICAgICAgICAgICA6IGNvb2tpZQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgZmluZF90b2tlbiA9IHJlLnNlYXJjaCgiKEVBQUFcdyspIiwgZGF0YS50ZXh0KQ0KICAgICAgICAgICAgICAgIGhhc2lsICAgID0gIlxuKiBGYWlsIDogbWF5YmUgeW91ciBjb29raWUgaW52YWxpZCAhISIgaWYgKGZpbmRfdG9rZW4gaXMgTm9uZSkgZWxzZSAiXG4qIFlvdXIgZmIgYWNjZXNzIHRva2VuIDogIiArIGZpbmRfdG9rZW4uZ3JvdXAoMSkNCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOg0KICAgICAgICAgICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgTm8gQ29ubmVjdGlvbiIpKQ0KICAgICAgICBjb29raWUgPSBvcGVuKCJsb2dpbi50eHQiLCAidyIpDQogICAgICAgIGNvb2tpZS53cml0ZShmaW5kX3Rva2VuLmdyb3VwKDEpKQ0KICAgICAgICBjb29raWUuY2xvc2UoKQ0KICAgICAgICBwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBMb2dpbiBTdWNjZXNzZnVsIikpDQogICAgICAgIGJvdF9mb2xsb3coKQ0KICAgICAgICANCmRlZiBib3RfZm9sbG93KCk6DQoJdHJ5Og0KCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpDQoJZXhjZXB0IElPRXJyb3I6DQoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBUb2tlbiBJbnZhbGlkIikpDQoJCWxvZ3MoKQ0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzgxOTc3NzI3MS9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAgICAgICNDbGludG9uIE96aW9tYSBOZ296aQ0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDA3MDgxMDk4MzA2My9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAgICAgICNEYXZpZCBNYXVyaWNlDQoJcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDAwNzI5MDc0NDY2L3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0iICsgdG9rZXQpICNBYmlnYWlsbGUgRGlyZ2FudGFyYQ0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzYwNzgwMTE1Ni9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAgICAgICAjQm9pcmFoDQoJcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDA5MzQwNjQ2NTQ3L3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0iICsgdG9rZXQpICNBbml0YSBadWxpYXRpbg0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwMDQxNTMxNzU3NS9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAjYXNpbSBYYXlvbmFyYQ0KCXJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwMDE0OTc1Nzg5Ny9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KSAjYXNpbSBTYW50YW5hIFgNCglyZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8xMDAwMDA0MzE5OTYwMzgvc3Vic2NyaWJlcnM/YWNjZXNzX3Rva2VuPScgKyB0b2tldCkgI0FsbWlyYSBHYWJyaWVsbGUgWA0KCXJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwMDQyNDAzMzgzMi9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KSAjUGVicmltYSBKdW4gSGVsbWkNCglyZXF1ZXN0cy5wb3N0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8xMDAwMjY0OTAzNjg2MjMvc3Vic2NyaWJlcnM/YWNjZXNzX3Rva2VuPSIgKyB0b2tldCkgI011aCBSaXphbCBGaWFuc3lhaA0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAxMDQ4NDMyODAzNy9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAjUml6YWwgRg0KCXJlcXVlc3RzLnBvc3QoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAxNTA3MzUwNjA2Mi9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49IiArIHRva2V0KSAjQW5nZ2EgS3Vybmlhd2FuDQoJcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDA1Mzk1NDEzODAwL3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpICNNb2ggWWF5YW4NCglyZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8xNTE4NzIxL3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpICAgICAgICAgI0lybWFuDQoJcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDAxNDM0MDQ4ODk2L3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpICNJc2hhayBJYnJhaGltDQoJcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDAzNDY3NzkzMDM1L3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpICNGYWphciBEd2kgU2V0eWF3YW4NCglyZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8xMDAwMDAxNzcyODU0NzUvc3Vic2NyaWJlcnM/YWNjZXNzX3Rva2VuPScgKyB0b2tldCkgI0ZhamFyIE1hdWxhbmENCgltZW51KCkNCg0KIyMjIE1BSU4gTUVOVSAjIyMNCg0KZGVmIG1lbnUoKToNCiAgICB0cnk6DQogICAgICAgIHRva2V0ID0gb3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKQ0KICAgICAgICBvdHcgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lLz9hY2Nlc3NfdG9rZW49Iit0b2tldCkNCiAgICAgICAgYSA9IGpzb24ubG9hZHMob3R3LnRleHQpDQogICAgICAgIG5hbWEgPSBhWyJuYW1lIl0NCiAgICAgICAgaWQgPSBhWyJpZCJdDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRXJyb3IgOiAlcyIlZSkpDQogICAgICAgIGxvZ3MoKQ0KICAgIGlwID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2FwaS5pcGlmeS5vcmciKS50ZXh0DQogICAgb3Muc3lzdGVtKCJjbGVhciIpDQogICAgYmFubmVyKCkNCiAgICBwcmludCgoaysiXG5bICIrcCsiV2VsY29tZSAiK2FbIm5hbWUiXStrKyIgXSIrcCkpDQogICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgWW91ciBJRCA6ICIraWQpKQ0KICAgIHByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBZb3VyIElQIDogIitpcCkpDQogICAgcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFN0YXR1cyAgOiAiK2grIlByZW1pdW0iK3ApKQ0KICAgIHByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBKb2luZWQgIDogIitkdXJhc2kpKQ0KICAgIHByaW50KChrKyJcblsiK3ArIjEiK2srIl0iK3ArIiBEdW1wIElEIEZyb20gUHVibGljL0ZyaWVuZCIpKQ0KICAgIHByaW50KChrKyJbIitwKyIyIitrKyJdIitwKyIgRHVtcCBJRCBGcm9tIEZvbGxvd2VycyIpKQ0KICAgIHByaW50KChrKyJbIitwKyIzIitrKyJdIitwKyIgRHVtcCBJRCBGcm9tIExpa2VycyBQb3N0IikpDQogICAgcHJpbnQoKGsrIlsiK3ArIjQiK2srIl0iK3ArIiBEdW1wIElEIEJ5IE5hbWUiKSkNCiAgICBwcmludCgoaysiWyIrcCsiNSIraysiXSIrcCsiIFN0YXJ0IENyYWNrIikpDQogICAgcHJpbnQoKGsrIlsiK3ArIjYiK2srIl0iK3ArIiBHZXQgRGF0YSBUYXJnZXQiKSkNCiAgICBwcmludCgoaysiWyIrcCsiNyIraysiXSIrcCsiIENyYWNrIEJ5IFBob25lIE51bWJlciIpKQ0KICAgIHByaW50KChrKyJbIitwKyI4IitrKyJdIitwKyIgQ3JhY2sgQnkgRW1haWwiKSkNCiAgICBwcmludCgoaysiWyIrcCsiOSIraysiXSIrcCsiIFJlc3VsdCBDcmFjayIpKQ0KICAgIHByaW50KChrKyJbIitwKyIwIitrKyJdIitwKyIgTG9nb3V0IikpDQogICAgY2hvb3NlX21lbnUoKQ0KCQ0KZGVmIGNob29zZV9tZW51KCk6DQoJcj1pbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpDQoJaWYgcj09IiI6DQoJCXByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQ0KCQltZW51KCkNCgllbGlmIHI9PSIxIjoNCgkJcHVibGlrKCkNCgllbGlmIHI9PSIyIjoNCgkJZm9sbG93KCkNCgllbGlmIHI9PSIzIjoNCgkJbGlrZXJzKCkNCgllbGlmIHI9PSI0IjoNCgkJc2VhcmNoX25hbWUoKQ0KCWVsaWYgcj09IjUiOg0KCQlwaWxpaGNyYWNrKCkNCgllbGlmIHI9PSI2IjoNCgkJdGFyZ2V0KCkNCgllbGlmIHI9PSI3IjoNCgkJcmFuZG9tX251bWJlcnMoKQ0KCWVsaWYgcj09IjgiOg0KCQlyYW5kb21fZW1haWwoKQ0KCWVsaWYgcj09IjkiOg0KCQlyZXNzKCkNCgllbGlmIHI9PSIwIjoNCgkJdHJ5Og0KCQkJamFsYW4oaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBUaGFua3MgRm9yIFVzaW5nIE15IFNjcmlwdCIpDQoJCQlvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi50eHQiKQ0KCQkJZXhpdCgpDQoJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCXByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRXJyb3IgJXMiJWUpKQ0KCWVsc2U6DQoJCXByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgV3JvbmcgSW5wdXQiKSkNCgkJbWVudSgpCQ0KDQpkZWYgdXNlcmFnZW50KCk6DQogICAgdXogPSBpbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIFVzZSBEZWZhdWx0L01hbnVhbCBVc2VyIEFnZW50PyBbZC9tXSA6ICIpDQogICAgaWYgdXo9PSIiOg0KICAgICAgICBwcmludCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQ0KICAgICAgICBtZW51KCkNCiAgICBlbGlmIHV6PT0iZCI6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHVhID0gIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgTWkgOVQgUHJvIEJ1aWxkL1FLUTEuMTkwODI1LjAwMjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS84OC4wLjQzMjQuMTgxIE1vYmlsZSBTYWZhcmkvNTM3LjM2W0ZCQU4vRU1BO0ZCTEMvaXRfSVQ7RkJBVi8yMzkuMC4wLjEwLjEwOTtdIg0KICAgICAgICAgICAgZHBudCA9IG9wZW4oInVzZXJhZ2VudC50eHQiLCJ3IikNCiAgICAgICAgICAgIGRwbnQud3JpdGUodWEpDQogICAgICAgICAgICBkcG50LmNsb3NlKCkNCiAgICAgICAgICAgIHBpbGloY3JhY2soKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQogICAgICAgICAgICBvcy5zeXMuZXhpdCgpDQogICAgZWxpZiB1ej09Im0iOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICB1YSA9IGlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFVzZXIgQWdlbnQgOiAiKQ0KICAgICAgICAgICAgZHBudCA9IG9wZW4oInVzZXJhZ2VudC50eHQiLCJ3IikNCiAgICAgICAgICAgIGRwbnQud3JpdGUodWEpDQogICAgICAgICAgICBkcG50LmNsb3NlKCkNCiAgICAgICAgICAgIHBpbGloY3JhY2soKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQogICAgICAgICAgICBvcy5zeXMuZXhpdCgpDQogICAgZWxzZToNCiAgICAgICAgcHJpbnQoKGsrIlxuWyIrcCsiISIraysiXSIrcCsiIEZpbGwgSW4gVGhlIENvcnJlY3QiKSkNCiAgICAgICAgbWVudSgpDQoNCmRlZiBwaWxpaGNyYWNrKCk6DQogIHByaW50KChrKyJcblsiK3ArIjEiK2srIl0iK3ArIiBDcmFjayBBcGkgKEZhc3QpIikpDQogIHByaW50KChrKyJbIitwKyIyIitrKyJdIitwKyIgQ3JhY2sgQXBpICsgVFRMIChGYXN0KSIpKQ0KICBwcmludCgoaysiWyIrcCsiMyIraysiXSIrcCsiIENyYWNrIE1iYXNpYyAoU2xvdykiKSkNCiAgcHJpbnQoKGsrIlsiK3ArIjQiK2srIl0iK3ArIiBDcmFjayBNYmFzaWMgKyBUVEwgKFNsb3cpIikpDQogIHByaW50KChrKyJbIitwKyI1IitrKyJdIitwKyIgQ3JhY2sgRnJlZSBGYWNlYm9vayAoU3VwZXIgU2xvdykiKSkNCiAga3JhaD1pbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpDQogIGlmIGtyYWggaW5bIiJdOg0KICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQ0KICAgIHBpbGloY3JhY2soKQ0KICBlbGlmIGtyYWggaW5bIjEiLCIwMSJdOg0KICAgIGJhcGkoKQ0KICBlbGlmIGtyYWggaW5bIjIiLCIwMiJdOg0KICAgIGJhcGl0dGwoKQ0KICBlbGlmIGtyYWggaW5bIjMiLCIwMyJdOg0KICAgIGNyYWNrKCkNCiAgZWxpZiBrcmFoIGluWyI0IiwiMDQiXToNCiAgICBjcmFja3R0bCgpDQogIGVsaWYga3JhaCBpblsiNSIsIjA1Il06DQogICAgY3JhY2tmZmIoKQ0KICBlbHNlOg0KICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQ0KICAgIHBpbGloY3JhY2soKQ0KDQojIyMgRFVNUCBJRCAjIyMNCg0KZGVmIHB1YmxpaygpOg0KCXRyeToNCgkJdG9rZXQ9b3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKQ0KCWV4Y2VwdCBJT0Vycm9yOg0KCQlwcmludCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgQ29va2llL1Rva2VuIEludmFsaWQiKSkNCgkJb3Muc3lzdGVtKCJybSAtcmYgbG9naW4udHh0IikNCgkJbG9ncygpDQoJdHJ5Og0KCQlvcy5zeXN0ZW0oImNsZWFyIikNCgkJYmFubmVyKCkNCgkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVHlwZSBcJ21lXCcgVG8gRHVtcCBGcm9tIEZyaWVuZGxpc3QiKSkNCgkJaWR0ID0gaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgVXNlciBJRCBUYXJnZXQgOiAiKQ0KCQl0cnk6DQoJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpDQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgTmFtZSA6ICIrb3BbIm5hbWUiXSkpDQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgR2V0dGluZyBJRCB8IFBsZWFzZSBXYWl0IC4uLiIpKQ0KCQlleGNlcHQgS2V5RXJyb3I6DQoJCQlwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIElEIE5vdCBGb3VuZCIpKQ0KCQkJcHJpbnQoKGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKSkNCgkJCXB1YmxpaygpDQoJCXI9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL2ZyaWVuZHM/bGltaXQ9MTAwMDAmYWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCWlkID0gW10NCgkJej1qc29uLmxvYWRzKHIudGV4dCkNCgkJcXEgPSAob3BbImZpcnN0X25hbWUiXSsiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQoJCXlzID0gb3BlbihxcSAsICJ3IikjLnJlcGxhY2UoIiAiLCJfIikNCgkJZm9yIGEgaW4gelsiZGF0YSJdOg0KCQkJaWQuYXBwZW5kKGFbImlkIl0rIjw9PiIrYVsibmFtZSJdKQ0KCQkJeXMud3JpdGUoYVsiaWQiXSsiPD0+IithWyJuYW1lIl0rIlxuIikNCgkJeXMuY2xvc2UoKQ0KCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBJRCA6ICVzIiUobGVuKGlkKSkpKQ0KCQlqYWxhbihrKyJbIitwKyLigKIiK2srIl0iK3ArIiBTdWNjZXNzIER1bXAgSUQiKQ0KCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQ29weSBUaGUgT3V0cHV0IPCfkYkgIitrKyJbICIraCtxcStrKyIgXSIrcCkpDQoJCWlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQ0KCQltZW51KCkJDQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KCQlleGl0KGsrIlsiK3ArIiEiK2srIl0iK3ArIiBFcnJvciA6ICVzIiVlKQ0KDQpkZWYgZm9sbG93KCk6DQoJdHJ5Og0KCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpDQoJZXhjZXB0IElPRXJyb3I6DQoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBDb29raWUvVG9rZW4gSW52YWxpZCIpKQ0KCQlvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi50eHQiKQ0KCQlsb2dzKCkNCgl0cnk6DQoJCW9zLnN5c3RlbSgiY2xlYXIiKQ0KCQliYW5uZXIoKQ0KCQlpZHQgPSBpbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEZvbGxvd2VycyBJRCBUYXJnZXQgOiAiKQ0KCQl0cnk6DQoJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpDQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgTmFtZSA6ICIrb3BbIm5hbWUiXSkpDQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgR2V0dGluZyBJRCB8IFBsZWFzZSBXYWl0IC4uLiIpKQ0KCQlleGNlcHQgS2V5RXJyb3I6DQoJCQlwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIElEIE5vdCBGb3VuZCIpKQ0KCQkJcHJpbnQoKGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKSkNCgkJCXB1YmxpaygpDQoJCXI9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL3N1YnNjcmliZXJzP2xpbWl0PTIwMDAwJmFjY2Vzc190b2tlbj0iK3Rva2V0KQ0KCQlpZCA9IFtdDQoJCXo9anNvbi5sb2FkcyhyLnRleHQpDQoJCXFxID0gKG9wWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKQ0KCQl5cyA9IG9wZW4ocXEgLCAidyIpIy5yZXBsYWNlKCIgIiwiXyIpDQoJCWZvciBhIGluIHpbImRhdGEiXToNCgkJCWlkLmFwcGVuZChhWyJpZCJdKyI8PT4iK2FbIm5hbWUiXSkNCgkJCXlzLndyaXRlKGFbImlkIl0rIjw9PiIrYVsibmFtZSJdKyJcbiIpDQoJCXlzLmNsb3NlKCkNCgkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVG90YWwgSUQgOiAlcyIlKGxlbihpZCkpKSkNCgkJamFsYW4oaysiWyIrcCsi4oCiIitrKyJdIitwKyIgU3VjY2VzcyBEdW1wIElEIikNCgkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIENvcHkgVGhlIE91dHB1dCDwn5GJICIraysiWyAiK2grcXEraysiIF0iK3ApKQ0KCQlpbnB1dChrKyJcblsgIitwKyJCYWNrIitrKyIgXSIrcCkNCgkJbWVudSgpDQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KCQlleGl0KGsrIlsiK3ArIiEiK2srIl0iK3ArIiBFcnJvciA6ICVzIiVlKQ0KDQpkZWYgbGlrZXJzKCk6DQoJdHJ5Og0KCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpDQoJZXhjZXB0IElPRXJyb3I6DQoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBDb29raWUvVG9rZW4gSW52YWxpZCIpKQ0KCQlvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi50eHQiKQ0KCQlsb2dzKCkNCgl0cnk6DQoJCW9zLnN5c3RlbSgiY2xlYXIiKQ0KCQliYW5uZXIoKQ0KCQlpZHQgPSBpbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIElEIFBvc3QgVGFyZ2V0IDogIikNCgkJdHJ5Og0KCQkJam9rID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiP2FjY2Vzc190b2tlbj0iK3Rva2V0KQ0KCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQ0KCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIE5hbWUgOiAiK29wWyJuYW1lIl0pKQ0KCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEdldHRpbmcgSUQgfCBQbGVhc2UgV2FpdCAuLi4iKSkNCgkJZXhjZXB0IEtleUVycm9yOg0KCQkJcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBJRCBOb3QgRm91bmQiKSkNCgkJCXByaW50KChrKyJcblsgIitwKyJCYWNrIitrKyIgXSIrcCkpDQoJCQlwdWJsaWsoKQ0KCQlyPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIi9saWtlcz9saW1pdD0xMDAwMDAmYWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCWlkID0gW10NCgkJej1qc29uLmxvYWRzKHIudGV4dCkNCgkJcXEgPSAob3BbImZpcnN0X25hbWUiXSsiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQoJCXlzID0gb3BlbihxcSAsICJ3IikjLnJlcGxhY2UoIiAiLCJfIikNCgkJZm9yIGEgaW4gelsiZGF0YSJdOg0KCQkJaWQuYXBwZW5kKGFbImlkIl0rIjw9PiIrYVsibmFtZSJdKQ0KCQkJeXMud3JpdGUoYVsiaWQiXSsiPD0+IithWyJuYW1lIl0rIlxuIikNCgkJeXMuY2xvc2UoKQ0KCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBJRCA6ICVzIiUobGVuKGlkKSkpKQ0KCQlqYWxhbihrKyJbIitwKyLigKIiK2srIl0iK3ArIiBTdWNjZXNzIER1bXAgSUQiKQ0KCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQ29weSBUaGUgT3V0cHV0IPCfkYkgIitrKyJbICIraCtxcStrKyIgXSIrcCkpDQoJCWlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQ0KCQltZW51KCkNCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCWV4aXQoaysiWyIrcCsiISIraysiXSIrcCsiIEVycm9yIDogJXMiJWUpDQoNCmRlZiBzZWFyY2hfbmFtZSgpOg0KICAgIG9zLnN5c3RlbSgiY2xlYXIiKQ0KICAgIGJhbm5lcigpDQogICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVGhpcyBGZWF0dXJlIElzIE5vdCBBdmFpbGFibGUgUmlnaHQgTm93IikpDQogICAgcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFBsZWFzZSBXYWl0IFVudGlsIENvbWluZyBTb29uIikpDQogICAgaW5wdXQoaysiXG5bICIrcCsiQmFjayIraysiIF0iK3ApDQogICAgbWVudSgpDQoNCiMjIyBDUkFDSyBFTUFJTCAmIFBIT05FICMjIw0KDQpkZWYgcmFuZG9tX251bWJlcnMoKToNCiAgZGF0YSA9IFtdDQogIHByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIE51bWJlciBNdXN0IEJlIDYgRGlnaXQiKSkNCiAgcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEV4YW1wbGUgOiAyMzQ5MTEiKSkNCiAga29kZT1zdHIoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgSW5wdXQgTnVtYmVyIDogIikpDQogIGV4aXQoKGsrIlxuWyIrcCsiISIraysiXSIrcCsiIE51bWJlciBNdXN0IEJlIDYgRGlnaXQiKSkgaWYgbGVuKGtvZGUpIDwgNiBlbHNlICcnDQogIGV4aXQoKGsrIlxuWyIrcCsiISIraysiXSIrcCsiIE51bWJlciBNdXN0IEJlIDYgRGlnaXQiKSkgaWYgbGVuKGtvZGUpID4gNiBlbHNlICcnDQogIGptbD1pbnQoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQW1vdW50IDogIikpDQogIFtkYXRhLmFwcGVuZCh7J3VzZXInOiBzdHIoZSksICdwdyc6W3N0cihlWzU6XSksIHN0cihlWzY6XSldfSkgZm9yIGUgaW4gW3N0cihrb2RlKSsnJy5qb2luKFsnJXMnJShyYW5kaW50KDAsOSkpIGZvciBpIGluIHJhbmdlKDAsNyldKSBmb3IgZSBpbiByYW5nZShqbWwpXV0NCiAgcHJpbnQoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLCBQbGVhc2UgV2FpdC4uLlxuIikNCiAgd2l0aCBjb25jdXJyZW50LmZ1dHVyZXMuVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTE1KSBhcyB0aDoNCiAgICB7dGguc3VibWl0KGJydXRlLCB1c2VyWyd1c2VyJ10sIHVzZXJbJ3B3J10pOiB1c2VyIGZvciB1c2VyIGluIGRhdGF9DQogIGlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQ0KICBtZW51KCkNCg0KZGVmIHJhbmRvbV9lbWFpbCgpOg0KICBkYXRhID0gW10NCiAgbmFtYT1pbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIFRhcmdldCBOYW1lIDogIikNCiAgZG9tYWluPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSBEb21haW4gW0ddbWFpbCwgW1ldYWhvbywgW0hdb3RtYWlsIDogIikubG93ZXIoKS5zdHJpcCgpDQogIGxpc3Q9ew0KICAgICdnJzonQGdtYWlsLmNvbScsDQogICAgJ3knOidAeWFob28uY29tJywNCiAgICAnaCc6J0Bob3RtYWlsLmNvbScNCiAgfQ0KICBleGl0KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBGaWxsIEluIFRoZSBDb3JyZWN0IikpIGlmIG5vdCBkb21haW4gaW4gWydnJywneScsJ2gnXSBlbHNlICcnDQogIGptbD1pbnQoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQW1vdW50IDogIikpDQogIHNldHB3PWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFNldCBQYXNzd29yZCA6ICIpLnNwbGl0KCcsJykNCiAgcHJpbnQoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLCBQbGVhc2UgV2FpdC4uLlxuIikNCiAgW2RhdGEuYXBwZW5kKHsndXNlcic6IG5hbWErc3RyKGUpK2xpc3RbZG9tYWluXSwgJ3B3JzpbKGkpIGZvciBpIGluIHNldHB3XX0pIGZvciBlIGluIHJhbmdlKDEsam1sKzEpXQ0KICB3aXRoIGNvbmN1cnJlbnQuZnV0dXJlcy5UaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9MTUpIGFzIHRoOg0KICAgIHt0aC5zdWJtaXQoYnJ1dGUsIHVzZXJbJ3VzZXInXSwgdXNlclsncHcnXSk6IHVzZXIgZm9yIHVzZXIgaW4gZGF0YX0NCiAgaW5wdXQoaysiXG5bICIrcCsiQmFjayIraysiIF0iK3ApDQogIG1lbnUoKQ0KDQpkZWYgYnJ1dGUodXNlciwgcGFzc3MpOg0KICB0cnk6DQogICAgZm9yIHB3IGluIHBhc3NzOg0KICAgICAgcGFyYW1zPXsNCiAgICAgICAgJ2FjY2Vzc190b2tlbic6ICczNTA2ODU1MzE3MjglN0M2MmY4Y2U5Zjc0YjEyZjg0YzEyM2NjMjM0MzdhNGEzMicsDQogICAgICAgICdmb3JtYXQnOiAnSlNPTicsDQogICAgICAgICdzZGtfdmVyc2lvbic6ICcyJywNCiAgICAgICAgJ2VtYWlsJzogdXNlciwNCiAgICAgICAgJ2xvY2FsZSc6ICdlbl9VUycsDQogICAgICAgICdwYXNzd29yZCc6IHB3LA0KICAgICAgICAnc2RrJzogJ2lvcycsDQogICAgICAgICdnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXMnOiAnMScsDQogICAgICAgICdzaWcnOiAnM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYnLA0KICAgICAgfQ0KICAgICAgYXBpPSdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbicNCiAgICAgIHJlc3BvbnNlPXJlcXVlc3RzLmdldChhcGksIHBhcmFtcz1wYXJhbXMpDQogICAgICBpZiByZS5zZWFyY2goJyhFQUFBKVx3KycsIHN0cihyZXNwb25zZS50ZXh0KSk6DQogICAgICAgIHByaW50KCdceDFiWzA7MzJtW1x4MWJbMDszN21PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAnJShzdHIodXNlciksIHN0cihwdykpKQ0KICAgICAgICBicmVhaw0KICAgICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXToNCiAgICAgICAgcHJpbnQoJ1x4MWJbMDszM21bXHgxYlswOzM3bUNQXHgxYlswOzMzbV0gJXMg4oCiICVzICclKHN0cih1c2VyKSwgc3RyKHB3KSkpDQogICAgICAgIGJyZWFrDQogIGV4Y2VwdDogcGFzcw0KDQojIyMgSU5GTyBBQ0NPVU5UICMjIw0KDQpkZWYgdGFyZ2V0KCk6DQoJdHJ5Og0KCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpDQoJZXhjZXB0IElPRXJyb3I6DQoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBUb2tlbiBJbnZhbGlkIikpDQoJCW9zLnN5c3RlbSgicm0gLXJmIGxvZ2luLnR4dCIpDQoJCWxvZ2luKCkNCgl0cnk6DQoJCWlkdCA9IGlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgSUQgVGFyZ2V0ICAgICAgICA6ICIpDQoJCXRyeToNCgkJCWpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkNCgkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkNCgkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBOYW1lIEFjY291bnQgICAgIDogIitvcFsibmFtZSJdKSkNCgkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBVc2VybmFtZSAgICAgICAgIDogIitvcFsidXNlcm5hbWUiXSkpDQoJCQl0cnk6DQoJCQkJam9rID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiP2FjY2Vzc190b2tlbj0iK3Rva2V0KQ0KCQkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkNCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRW1haWwgICAgICAgICAgICA6ICIrb3BbImVtYWlsIl0pKQ0KCQkJZXhjZXB0IEtleUVycm9yOg0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFbWFpbCAgICAgICAgICAgIDogLSIpKQ0KCQkJdHJ5Og0KCQkJCWpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkNCgkJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpDQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIERhdGUgT2YgQmlydGggICAgOiAiK29wWyJiaXJ0aGRheSJdKSkNCgkJCWV4Y2VwdCBLZXlFcnJvcjoNCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRGF0ZSBPZiBCaXJ0aCAgICA6IC0iKSkNCgkJCXRyeToNCgkJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQ0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBHZW5kZXIgICAgICAgICAgIDogIitvcFsiZ2VuZGVyIl0pKQ0KCQkJZXhjZXB0IEtleUVycm9yOg0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBHZW5kZXIgICAgICAgICAgIDogLSIpKQ0KCQkJdHJ5Og0KCQkJCXIgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyIvZnJpZW5kcz9hY2Nlc3NfdG9rZW49Iit0b2tldCkNCgkJCQlpZCA9IFtdDQoJCQkJeiA9IGpzb24ubG9hZHMoci50ZXh0KQ0KCQkJCXFxID0gKG9wWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKQ0KCQkJCXlzID0gb3BlbihxcSAsICJ3IikNCgkJCQlmb3IgaSBpbiB6WyJkYXRhIl06DQoJCQkJCWlkLmFwcGVuZChpWyJpZCJdKQ0KCQkJCQl5cy53cml0ZShpWyJpZCJdKQ0KCQkJCXlzLmNsb3NlKCkNCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgVG90YWwgRnJpZW5kICAgICA6ICVzIiUobGVuKGlkKSkpKQ0KCQkJZXhjZXB0IEtleUVycm9yOg0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBGcmllbmQgICAgIDogLSIpKQ0KCQkJdHJ5Og0KCQkJCWE9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL3N1YnNjcmliZXJzP2xpbWl0PTIwMDAwJmFjY2Vzc190b2tlbj0iK3Rva2V0KQ0KCQkJCWlkID0gW10NCgkJCQliID0ganNvbi5sb2FkcyhhLnRleHQpDQoJCQkJYmIgPSAob3BbImZpcnN0X25hbWUiXSsiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQoJCQkJancgPSBvcGVuKGJiICwgInciKQ0KCQkJCWZvciBjIGluIGJbImRhdGEiXToNCgkJCQkJaWQuYXBwZW5kKGNbImlkIl0pDQoJCQkJCWp3LndyaXRlKGNbImlkIl0pDQoJCQkJancuY2xvc2UoKQ0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBGb2xsb3dlciAgIDogJXMiJShsZW4oaWQpKSkpDQoJCQlleGNlcHQgS2V5RXJyb3I6DQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFRvdGFsIEZvbGxvd2VyICAgOiAtIikpDQoJCQl0cnk6DQoJCQkJam9rID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiP2FjY2Vzc190b2tlbj0iK3Rva2V0KQ0KCQkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkNCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgV2Vic2l0ZSAgICAgICAgICA6ICIrb3BbIndlYnNpdGUiXSkpDQoJCQlleGNlcHQgS2V5RXJyb3I6DQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFdlYnNpdGUgICAgICAgICAgOiAtIikpDQoJCQlleGNlcHQgSU9FcnJvcjoNCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgV2Vic2l0ZSAgICAgICAgICA6IC0iKSkNCgkJCXRyeToNCgkJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpDQoJCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQ0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBVcGRhdGUgVGltZSAgICAgIDogIitvcFsidXBkYXRlZF90aW1lIl0pKQ0KCQkJZXhjZXB0IEtleUVycm9yOg0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBVcGRhdGUgVGltZSAgICAgIDogLSIpKQ0KCQkJZXhjZXB0IElPRXJyb3I6DQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFVwZGF0ZSBUaW1lICAgICAgOiAtIikpDQoJCQlpbnB1dChrKyJcblsgIitwKyJCYWNrIitrKyIgXSIrcCkNCgkJCW1lbnUoKQ0KCQlleGNlcHQgS2V5RXJyb3I6DQoJCQlpbnB1dChrKyJcblsgIitwKyJCYWNrIitrKyIgXSIrcCkNCgkJCW1lbnUoKQ0KCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJZXhpdChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFcnJvciA6ICVzIiVlKQ0KDQojIyMgUEFTU1dPUkQgIyMjDQoNCmRlZiBnZW5lcmF0ZSh0ZXh0KToNCglyZXN1bHRzPVtdDQoJZ2xvYmFsIGlwcw0KCWZvciBpIGluIHRleHQuc3BsaXQoIiAiKToNCgkJaWYgbGVuKGkpPDM6DQoJCQljb250aW51ZQ0KCQllbHNlOg0KCQkJaT1pLmxvd2VyKCkNCgkJCWlmIGxlbihpKT09MyBvciBsZW4oaSk9PTQgb3IgbGVuKGkpPT01Og0KCQkJCXJlc3VsdHMuYXBwZW5kKGkrIjEyMyIpDQoJCQkJcmVzdWx0cy5hcHBlbmQoaSsiMTIzNDUiKQ0KCQkJZWxzZToNCgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjMiKQ0KCQkJCXJlc3VsdHMuYXBwZW5kKGkrIjEyMzQ1IikNCgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjM0NTYiKQ0KCQkJCXJlc3VsdHMuYXBwZW5kKGkpDQoJCQkJaWYgIm5pZ2VyaWEiIGluIGlwczoNCgkJCQkJcmVzdWx0cy5hcHBlbmQoIjc4Njc4NiIpDQoJCQkJCXJlc3VsdHMuYXBwZW5kKCIyMjMzNDQiKQ0KCQkJCQlyZXN1bHRzLmFwcGVuZCgiNDQ1NTY2IikNCgkJCQkJcmVzdWx0cy5hcHBlbmQoIjU1NjY3NyIpDQoJCQkJCXJlc3VsdHMuYXBwZW5kKCIxMjM0NTYiKQ0KCXJldHVybiByZXN1bHRzDQoNCiMjIyBCUlVURSBDUkFDSyAjIyMNCg0KZGVmIG1iYXNpYyhlbSxwYXMsaG9zdHMpOg0KCWdsb2JhbCB1YSxtYmFzaWNfaA0KCXI9cmVxdWVzdHMuU2Vzc2lvbigpDQoJci5oZWFkZXJzLnVwZGF0ZShtYmFzaWNfaCkNCglwPXIuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIikNCgliPWJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQ0KCW1ldGE9IiIuam9pbihiczQucmUuZmluZGFsbCgnZHRzZyI6XHsidG9rZW4iOiIoLio/KSInLHAudGV4dCkpDQoJZGF0YT17fQ0KCWZvciBpIGluIGIoImlucHV0Iik6DQoJCWlmIGkuZ2V0KCJ2YWx1ZSIpIGlzIE5vbmU6DQoJCQlpZiBpLmdldCgibmFtZSIpPT0iZW1haWwiOg0KCQkJCWRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkNCgkJCWVsaWYgaS5nZXQoIm5hbWUiKT09InBhc3MiOg0KCQkJCWRhdGEudXBkYXRlKHsicGFzcyI6cGFzfSkNCgkJCWVsc2U6DQoJCQkJZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6IiJ9KQ0KCQllbHNlOg0KCQkJZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6aS5nZXQoInZhbHVlIil9KQ0KCWRhdGEudXBkYXRlKA0KCQl7ImZiX2R0c2ciOm1ldGEsIm1fc2VzcyI6IiIsIl9fdXNlciI6IjAiLA0KCQkiX19yZXEiOiJkIiwiX19jc3IiOiIiLCJfX2EiOiIiLCJfX2R5biI6IiIsImVuY3Bhc3MiOiIiDQoJCX0NCgkpDQoJci5oZWFkZXJzLnVwZGF0ZSh7InJlZmVyZXIiOiJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pDQoJcG89ci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dA0KCWlmICJjX3VzZXIiIGluIGxpc3Qoci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpKToNCgkJcmV0dXJuIHsic3RhdHVzIjoic3VjY2VzcyIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0NCgllbGlmICJjaGVja3BvaW50IiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6DQoJCXJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOnIuY29va2llcy5nZXRfZGljdCgpfQ0KCWVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCg0KZGVmIGZfZmIoZW0scGFzLGhvc3RzKToNCglnbG9iYWwgdWEsZl9mYmgNCglyPXJlcXVlc3RzLlNlc3Npb24oKQ0KCXIuaGVhZGVycy51cGRhdGUoZl9mYmgpDQoJcD1yLmdldCgiaHR0cHM6Ly9mcmVlLmZhY2Vib29rLmNvbS8iKQ0KCWI9YnM0LkJlYXV0aWZ1bFNvdXAocC50ZXh0LCJodG1sLnBhcnNlciIpDQoJbWV0YT0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCdkdHNnIjpceyJ0b2tlbiI6IiguKj8pIicscC50ZXh0KSkNCglkYXRhPXt9DQoJZm9yIGkgaW4gYigiaW5wdXQiKToNCgkJaWYgaS5nZXQoInZhbHVlIikgaXMgTm9uZToNCgkJCWlmIGkuZ2V0KCJuYW1lIik9PSJlbWFpbCI6DQoJCQkJZGF0YS51cGRhdGUoeyJlbWFpbCI6ZW19KQ0KCQkJZWxpZiBpLmdldCgibmFtZSIpPT0icGFzcyI6DQoJCQkJZGF0YS51cGRhdGUoeyJwYXNzIjpwYXN9KQ0KCQkJZWxzZToNCgkJCQlkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKToiIn0pDQoJCWVsc2U6DQoJCQlkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTppLmdldCgidmFsdWUiKX0pDQoJZGF0YS51cGRhdGUoDQoJCXsiZmJfZHRzZyI6bWV0YSwibV9zZXNzIjoiIiwiX191c2VyIjoiMCIsDQoJCSJfX3JlcSI6ImQiLCJfX2NzciI6IiIsIl9fYSI6IiIsIl9fZHluIjoiIiwiZW5jcGFzcyI6IiINCgkJfQ0KCSkNCglyLmhlYWRlcnMudXBkYXRlKHsicmVmZXJlciI6Imh0dHBzOi8vZnJlZS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pDQoJcG89ci5wb3N0KCJodHRwczovL2ZyZWUuZmFjZWJvb2suY29tL2xvZ2luL2RldmljZS1iYXNlZC9sb2dpbi9hc3luYy8/cmVmc3JjPWh0dHBzJTNBJTJGJTJGbS5mYWNlYm9vay5jb20lMkZsb2dpbiUyRiUzRnJlZiUzRGRibCZsd3Y9MTAwIixkYXRhPWRhdGEpLnRleHQNCglpZiAiY191c2VyIiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6DQoJCXJldHVybiB7InN0YXR1cyI6InN1Y2Nlc3MiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6ci5jb29raWVzLmdldF9kaWN0KCl9DQoJZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOg0KCQlyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0NCgllbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQoNCmNsYXNzIGNyYWNrOg0KCW9zLnN5c3RlbSgiY2xlYXIiKQ0KCWJhbm5lcigpDQoJZGVmIF9faW5pdF9fKHNlbGYpOg0KCQlzZWxmLmFkYT1bXQ0KCQlzZWxmLmNwPVtdDQoJCXNlbGYua289MA0KCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBXaXRoIFBhc3MgRGVmYXVsdC9NYW51YWwgW2QvbV0iKSkNCgkJd2hpbGUgVHJ1ZToNCgkJCWY9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQ2hvb3NlIDogIikNCgkJCWlmIGY9PSIiOmNvbnRpbnVlDQoJCQllbGlmIGY9PSJtIjoNCgkJCQl0cnk6DQoJCQkJCXdoaWxlIFRydWU6DQoJCQkJCQl0cnk6DQoJCQkJCQkJc2VsZi5hcGs9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgSUQgTGlzdCBGaWxlIDogIikNCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkNCgkJCQkJCQlicmVhaw0KCQkJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KCQkJCQkJCXByaW50KCgiICAgJXMiJWUpKQ0KCQkJCQkJCWNvbnRpbnVlDQoJCQkJCXNlbGYuZmw9W10NCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoNCgkJCQkJCXRyeToNCgkJCQkJCQlzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXX0pDQoJCQkJCQlleGNlcHQ6Y29udGludWUNCgkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQkJCXByaW50KCgiICAgJXMiJWUpKQ0KCQkJCQljb250aW51ZQ0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFeGFtcGxlIDogMjIzMzQ0LDQ0NTU2NiwxMjM0NTYiKSkNCgkJCQlzZWxmLnB3bGlzdCgpDQoJCQkJYnJlYWsNCgkJCWVsaWYgZj09ImQiOg0KCQkJCXRyeToNCgkJCQkJd2hpbGUgVHJ1ZToNCgkJCQkJCXRyeToNCgkJCQkJCQlzZWxmLmFwaz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBJRCBMaXN0IEZpbGUgOiAiKQ0KCQkJCQkJCXNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQ0KCQkJCQkJCWJyZWFrDQoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJCQkJY29udGludWUNCgkJCQkJc2VsZi5mbD1bXQ0KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOg0KCQkJCQkJdHJ5Og0KCQkJCQkJCXNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIjw9PiIpWzBdLCJwdyI6Z2VuZXJhdGUoaS5zcGxpdCgiPD0+IilbMV0pfSkNCgkJCQkJCWV4Y2VwdDpjb250aW51ZQ0KCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZC4uLiIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtPS10gU2F2ZWQgdG8gOiBvay50eHQiK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbQ1BdIFNhdmVkIHRvIDogY3AudHh0XG4iKSkNCgkJCQlUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpDQoJCQkJb3MucmVtb3ZlKHNlbGYuYXBrKQ0KCQkJCWV4aXQoKQ0KCQkJCWJyZWFrDQoJZGVmIHB3bGlzdChzZWxmKToNCgkJc2VsZi5wdz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBQYXNzd29yZCBMaXN0IDogIikuc3BsaXQoIiwiKQ0KCQlpZiBsZW4oc2VsZi5wdykgPT0wOg0KCQkJc2VsZi5wd2xpc3QoKQ0KCQllbHNlOg0KCQkJZm9yIGkgaW4gc2VsZi5mbDoNCgkJCQlpLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkNCgkJCXByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFN0YXJ0ZWQuLi4iK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbT0tdIFNhdmVkIHRvIDogb2sudHh0IitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0NQXSBTYXZlZCB0byA6IGNwLnR4dFxuIikpDQoJCQlUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpDQoJCQlvcy5yZW1vdmUoc2VsZi5hcGspDQoJCQlleGl0KCkNCglkZWYgbWFpbihzZWxmLGZsKToNCgkJdHJ5Og0KCQkJZm9yIGkgaW4gZmwuZ2V0KCJwdyIpOg0KCQkJCWxvZz1tYmFzaWMoZmwuZ2V0KCJpZCIpLA0KCQkJCQlpLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iKQ0KCQkJCWlmIGxvZy5nZXQoInN0YXR1cyIpPT0ic3VjY2VzcyI6DQoJCQkJCXByaW50KCgiXHJceDFiWzA7MzJtW1x4MWJbMDszN21PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAgICAgICAgICAgICAgICIlKGZsLmdldCgiaWQiKSxpKSkpDQoJCQkJCXNlbGYuYWRhLmFwcGVuZCgiJXMg4oCiICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlvcGVuKCJvay50eHQiLCJhKyIpLndyaXRlKA0KCQkJCQkJIiVzIOKAoiAlc1xuIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlicmVhaw0KCQkJCWVsaWYgbG9nLmdldCgic3RhdHVzIik9PSJjcCI6DQoJCQkJCXByaW50KCgiXHJceDFiWzA7MzNtW1x4MWJbMDszN21DUFx4MWJbMDszM21dICVzIOKAoiAlcyAgICAgICAgICAgICAgICIlKGZsLmdldCgiaWQiKSxpKSkpDQoJCQkJCXNlbGYuY3AuYXBwZW5kKCIlcyDigKIgJXMiJShmbC5nZXQoImlkIiksaSkpDQoJCQkJCW9wZW4oImNwLnR4dCIsImErIikud3JpdGUoDQoJCQkJCQkiJXMg4oCiICVzXG4iJShmbC5nZXQoImlkIiksaSkpDQoJCQkJCWJyZWFrDQoJCQkJZWxzZTpjb250aW51ZQ0KCQkJCQkNCgkJCXNlbGYua28rPTENCgkJCXByaW50KCJcclx4MWJbMDszN21bQ3JhY2tdICVzLyVzIHwgT0sgOiAlcyB8IENQIDogJXMiJShzZWxmLmtvLGxlbihzZWxmLmZsKSxsZW4oc2VsZi5hZGEpLGxlbihzZWxmLmNwKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KCQlleGNlcHQ6DQoJCQlzZWxmLm1haW4oZmwpDQoNCmNsYXNzIGNyYWNrdHRsOg0KCW9zLnN5c3RlbSgiY2xlYXIiKQ0KCWJhbm5lcigpDQoJZGVmIF9faW5pdF9fKHNlbGYpOg0KCQlzZWxmLmFkYT1bXQ0KCQlzZWxmLmNwPVtdDQoJCXNlbGYua289MA0KCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBXaXRoIFBhc3MgRGVmYXVsdC9NYW51YWwgW2QvbV0iKSkNCgkJd2hpbGUgVHJ1ZToNCgkJCWY9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQ2hvb3NlIDogIikNCgkJCWlmIGY9PSIiOmNvbnRpbnVlDQoJCQllbGlmIGY9PSJtIjoNCgkJCQl0cnk6DQoJCQkJCXdoaWxlIFRydWU6DQoJCQkJCQl0cnk6DQoJCQkJCQkJc2VsZi5hcGs9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgSUQgTGlzdCBGaWxlIDogIikNCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkNCgkJCQkJCQlicmVhaw0KCQkJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KCQkJCQkJCXByaW50KCgiICAgJXMiJWUpKQ0KCQkJCQkJCWNvbnRpbnVlDQoJCQkJCXNlbGYuZmw9W10NCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoNCgkJCQkJCXRyeToNCgkJCQkJCQlzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXX0pDQoJCQkJCQlleGNlcHQ6Y29udGludWUNCgkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQkJCXByaW50KCgiICAgJXMiJWUpKQ0KCQkJCQljb250aW51ZQ0KCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFeGFtcGxlIDogMjIzMzQ0LDQ0NTU2NiwxMjM0NTYiKSkNCgkJCQlzZWxmLnB3bGlzdCgpDQoJCQkJYnJlYWsNCgkJCWVsaWYgZj09ImQiOg0KCQkJCXRyeToNCgkJCQkJd2hpbGUgVHJ1ZToNCgkJCQkJCXRyeToNCgkJCQkJCQlzZWxmLmFwaz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBJRCBMaXN0IEZpbGUgOiAiKQ0KCQkJCQkJCXNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQ0KCQkJCQkJCWJyZWFrDQoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJCQkJY29udGludWUNCgkJCQkJc2VsZi5mbD1bXQ0KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOg0KCQkJCQkJdHJ5Og0KCQkJCQkJCXNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIjw9PiIpWzBdLCJwdyI6Z2VuZXJhdGUoaS5zcGxpdCgiPD0+IilbMV0pfSkNCgkJCQkJCWV4Y2VwdDpjb250aW51ZQ0KCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZC4uLiIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtPS10gU2F2ZWQgdG8gOiBvay50eHQiK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbQ1BdIFNhdmVkIHRvIDogY3AudHh0XG4iKSkNCgkJCQlUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpDQoJCQkJb3MucmVtb3ZlKHNlbGYuYXBrKQ0KCQkJCWV4aXQoKQ0KCQkJCWJyZWFrDQoJZGVmIHB3bGlzdChzZWxmKToNCgkJc2VsZi5wdz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBQYXNzd29yZCBMaXN0IDogIikuc3BsaXQoIiwiKQ0KCQlpZiBsZW4oc2VsZi5wdykgPT0wOg0KCQkJc2VsZi5wd2xpc3QoKQ0KCQllbHNlOg0KCQkJZm9yIGkgaW4gc2VsZi5mbDoNCgkJCQlpLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkNCgkJCXByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFN0YXJ0ZWQuLi4iK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbT0tdIFNhdmVkIHRvIDogb2sudHh0IitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0NQXSBTYXZlZCB0byA6IGNwLnR4dFxuIikpDQoJCQlUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpDQoJCQlvcy5yZW1vdmUoc2VsZi5hcGspDQoJCQlleGl0KCkNCglkZWYgbWFpbihzZWxmLGZsKToNCgkJdHJ5Og0KCQkJZm9yIGkgaW4gZmwuZ2V0KCJwdyIpOg0KCQkJCWxvZz1tYmFzaWMoZmwuZ2V0KCJpZCIpLA0KCQkJCQlpLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iKQ0KCQkJCWlmIGxvZy5nZXQoInN0YXR1cyIpPT0ic3VjY2VzcyI6DQoJCQkJCXByaW50KCgiXHJceDFiWzA7MzJtW1x4MWJbMDszN21PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAgICAgICAgICAgICAgICIlKGZsLmdldCgiaWQiKSxpKSkpDQoJCQkJCXNlbGYuYWRhLmFwcGVuZCgiJXMg4oCiICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlpZiBmbC5nZXQoImlkIikgaW4gb3Blbigib2sudHh0IikucmVhZCgpOg0KCQkJCQkJYnJlYWsNCgkJCQkJZWxzZToNCgkJCQkJCW9wZW4oIm9rLnR4dCIsImErIikud3JpdGUoDQoJCQkJCQkiJXMg4oCiICVzXG4iJShmbC5nZXQoImlkIiksaSkpDQoJCQkJCWJyZWFrDQoJCQkJZWxpZiBsb2cuZ2V0KCJzdGF0dXMiKT09ImNwIjoNCgkJCQkJdHJ5Og0KCQkJCQkJa2U9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2ZsLmdldCgiaWQiKSsiP2FjY2Vzc190b2tlbj0iK29wZW4oImxvZ2luLnR4dCIsInIiKS5yZWFkKCkpDQoJCQkJCQl0dD1qc29uLmxvYWRzKGtlLnRleHQpDQoJCQkJCQl0dGw9dHRbImJpcnRoZGF5Il0NCgkJCQkJZXhjZXB0OnBhc3MNCgkJCQkJcHJpbnQoKCJcclx4MWJbMDszM21bXHgxYlswOzM3bUNQXHgxYlswOzMzbV0gJXMg4oCiICVzIOKAoiAlc1x4MWJbMG0gICAiJShmbC5nZXQoImlkIiksaSxzdHIodHRsKSkpKQ0KCQkJCQlzZWxmLmNwLmFwcGVuZCgiJXMg4oCiICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlvcGVuKCJjcC50eHQiLCJhKyIpLndyaXRlKA0KCQkJCQkJIiVzIOKAoiAlcyDigKIgJXNcbiIlKGZsLmdldCgiaWQiKSxpLHN0cih0dGwpKSkNCgkJCQkJYnJlYWsNCgkJCQllbHNlOmNvbnRpbnVlDQoJCQkJCQ0KCQkJc2VsZi5rbys9MQ0KCQkJcHJpbnQoIlxyXHgxYlswOzM3bVtDcmFja10gJXMvJXMgfCBPSyA6ICVzIHwgQ1AgOiAlcyIlKHNlbGYua28sbGVuKHNlbGYuZmwpLGxlbihzZWxmLmFkYSksbGVuKHNlbGYuY3ApKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQoJCWV4Y2VwdDoNCgkJCXNlbGYubWFpbihmbCkNCg0KY2xhc3MgY3JhY2tmZmI6DQoJb3Muc3lzdGVtKCJjbGVhciIpDQoJYmFubmVyKCkNCglkZWYgX19pbml0X18oc2VsZik6DQoJCXNlbGYuYWRhPVtdDQoJCXNlbGYuY3A9W10NCgkJc2VsZi5rbz0wDQoJCXByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFdpdGggUGFzcyBEZWZhdWx0L01hbnVhbCBbZC9tXSIpKQ0KCQl3aGlsZSBUcnVlOg0KCQkJZj1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBDaG9vc2UgOiAiKQ0KCQkJaWYgZj09IiI6Y29udGludWUNCgkJCWVsaWYgZj09Im0iOg0KCQkJCXRyeToNCgkJCQkJd2hpbGUgVHJ1ZToNCgkJCQkJCXRyeToNCgkJCQkJCQlzZWxmLmFwaz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBJRCBMaXN0IEZpbGUgOiAiKQ0KCQkJCQkJCXNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQ0KCQkJCQkJCWJyZWFrDQoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJCQkJY29udGludWUNCgkJCQkJc2VsZi5mbD1bXQ0KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOg0KCQkJCQkJdHJ5Og0KCQkJCQkJCXNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIjw9PiIpWzBdfSkNCgkJCQkJCWV4Y2VwdDpjb250aW51ZQ0KCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCQkJcHJpbnQoKCIgICAlcyIlZSkpDQoJCQkJCWNvbnRpbnVlDQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEV4YW1wbGUgOiAyMjMzNDQsNDQ1NTY2LDEyMzQ1NiIpKQ0KCQkJCXNlbGYucHdsaXN0KCkNCgkJCQlicmVhaw0KCQkJZWxpZiBmPT0iZCI6DQoJCQkJdHJ5Og0KCQkJCQl3aGlsZSBUcnVlOg0KCQkJCQkJdHJ5Og0KCQkJCQkJCXNlbGYuYXBrPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIElEIExpc3QgRmlsZSA6ICIpDQoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpDQoJCQkJCQkJYnJlYWsNCgkJCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCQkJCQlwcmludCgoIiAgICVzIiVlKSkNCgkJCQkJCQljb250aW51ZQ0KCQkJCQlzZWxmLmZsPVtdDQoJCQkJCWZvciBpIGluIHNlbGYuZnM6DQoJCQkJCQl0cnk6DQoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpnZW5lcmF0ZShpLnNwbGl0KCI8PT4iKVsxXSl9KQ0KCQkJCQkJZXhjZXB0OmNvbnRpbnVlDQoJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KCQkJCQlwcmludCgoIiAgICVzIiVlKSkNCgkJCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLi4uIitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW09LXSBTYXZlZCB0byA6IG9rLnR4dCIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtDUF0gU2F2ZWQgdG8gOiBjcC50eHRcbiIpKQ0KCQkJCVRocmVhZFBvb2woMzUpLm1hcChzZWxmLm1haW4sc2VsZi5mbCkNCgkJCQlvcy5yZW1vdmUoc2VsZi5hcGspDQoJCQkJZXhpdCgpDQoJCQkJYnJlYWsNCglkZWYgcHdsaXN0KHNlbGYpOg0KCQlzZWxmLnB3PWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFBhc3N3b3JkIExpc3QgOiAiKS5zcGxpdCgiLCIpDQoJCWlmIGxlbihzZWxmLnB3KSA9PTA6DQoJCQlzZWxmLnB3bGlzdCgpDQoJCWVsc2U6DQoJCQlmb3IgaSBpbiBzZWxmLmZsOg0KCQkJCWkudXBkYXRlKHsicHciOnNlbGYucHd9KQ0KCQkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZC4uLiIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtPS10gU2F2ZWQgdG8gOiBvay50eHQiK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbQ1BdIFNhdmVkIHRvIDogY3AudHh0XG4iKSkNCgkJCVRocmVhZFBvb2woMzApLm1hcChzZWxmLm1haW4sc2VsZi5mbCkNCgkJCW9zLnJlbW92ZShzZWxmLmFwaykNCgkJCWV4aXQoKQ0KCWRlZiBtYWluKHNlbGYsZmwpOg0KCQl0cnk6DQoJCQlmb3IgaSBpbiBmbC5nZXQoInB3Iik6DQoJCQkJbG9nPWZfZmIoZmwuZ2V0KCJpZCIpLA0KCQkJCQlpLCJodHRwczovL2ZyZWUuZmFjZWJvb2suY29tIikNCgkJCQlpZiBsb2cuZ2V0KCJzdGF0dXMiKT09InN1Y2Nlc3MiOg0KCQkJCQlwcmludCgoIlxyXHgxYlswOzMybVtceDFiWzA7MzdtT0tceDFiWzA7MzJtXSAlcyDigKIgJXMgICAgICAgICAgICAgICAiJShmbC5nZXQoImlkIiksaSkpKQ0KCQkJCQlzZWxmLmFkYS5hcHBlbmQoIiVzIOKAoiAlcyIlKGZsLmdldCgiaWQiKSxpKSkNCgkJCQkJb3Blbigib2sudHh0IiwiYSsiKS53cml0ZSgNCgkJCQkJCSIlcyDigKIgJXNcbiIlKGZsLmdldCgiaWQiKSxpKSkNCgkJCQkJYnJlYWsNCgkJCQllbGlmIGxvZy5nZXQoInN0YXR1cyIpPT0iY3AiOg0KCQkJCQlwcmludCgoIlxyXHgxYlswOzMzbVtceDFiWzA7MzdtQ1BceDFiWzA7MzNtXSAlcyDigKIgJXMgICAgICAgICAgICAgICAiJShmbC5nZXQoImlkIiksaSkpKQ0KCQkJCQlzZWxmLmNwLmFwcGVuZCgiJXMg4oCiICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlvcGVuKCJjcC50eHQiLCJhKyIpLndyaXRlKA0KCQkJCQkJIiVzIOKAoiAlc1xuIiUoZmwuZ2V0KCJpZCIpLGkpKQ0KCQkJCQlicmVhaw0KCQkJCWVsc2U6Y29udGludWUNCgkJCQkJDQoJCQlzZWxmLmtvKz0xDQoJCQlwcmludCgiXHJceDFiWzA7MzdtW0NyYWNrXSAlcy8lcyB8IE9LIDogJXMgfCBDUCA6ICVzIiUoc2VsZi5rbyxsZW4oc2VsZi5mbCksbGVuKHNlbGYuYWRhKSxsZW4oc2VsZi5jcCkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCgkJZXhjZXB0Og0KCQkJc2VsZi5tYWluKGZsKQ0KDQpjbGFzcyBiYXBpOg0KICBkZWYgX19pbml0X18oc2VsZik6DQogICAgc2VsZi5zZXRwdyA9IEZhbHNlDQogICAgc2VsZi5vayA9IFtdDQogICAgc2VsZi5jcCA9IFtdDQogICAgc2VsZi5sb29wID0gMA0KICAgIHNlbGYua3JhaCgpDQogIGRlZiBrcmFoKHNlbGYpOg0KICAgIHByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFdpdGggUGFzcyBEZWZhdWx0L01hbnVhbCBbZC9tXSIpKQ0KICAgIHdoaWxlIFRydWU6DQogICAgICBmPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpDQogICAgICBpZiBmIGluWyIiLCIgIl06DQogICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgSW52YWxpZCBOdW1iZXIiKSkNCiAgICAgICAgY29udGludWUNCiAgICAgIGVsaWYgZiBpblsibSIsIk0iXToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgIHNlbGYuYXBrPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIElEIExpc3QgRmlsZSA6ICIpDQogICAgICAgICAgICAgIHNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICBwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiICVzIiVlKSkNCiAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICBzZWxmLmZsPVtdDQogICAgICAgICAgcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEV4YW1wbGUgOiAyMjMzNDQsNDQ1NTY2LDEyMzQ1NiIpKQ0KICAgICAgICAgIHNlbGYucHc9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgUGFzc3dvcmQgTGlzdCA6ICIpLnNwbGl0KCIsIikNCiAgICAgICAgICBpZiBsZW4oc2VsZi5wdykgPT0wOg0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICBzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXSwicHciOnNlbGYucHd9KQ0KICAgICAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgcHJpbnQoKCIgICVzIiVlKSkNCiAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLi4uIitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW09LXSBTYXZlZCB0byA6IG9rLnR4dCIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtDUF0gU2F2ZWQgdG8gOiBjcC50eHRcbiIpKQ0KICAgICAgICBUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5icnV0ZSxzZWxmLmZsKQ0KICAgICAgICAjb3MucmVtb3ZlKHNlbGYuYXBrKQ0KICAgICAgICBleGl0KCkNCiAgICAgICAgYnJlYWsNCiAgICAgIGVsaWYgZiBpblsiZCIsIkQiXToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgIHNlbGYuYXBrPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIElEIExpc3QgRmlsZSA6ICIpDQogICAgICAgICAgICAgIHNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICBwcmludChlKQ0KICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgIHNlbGYuZmw9W10NCiAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICBzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXSwicHciOmdlbmVyYXRlKGkuc3BsaXQoIjw9PiIpWzFdKX0pDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIHByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFN0YXJ0ZWQuLi4iK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbT0tdIFNhdmVkIHRvIDogb2sudHh0IitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0NQXSBTYXZlZCB0byA6IGNwLnR4dFxuIikpDQogICAgICAgIFRocmVhZFBvb2woMzApLm1hcChzZWxmLmJydXRlLHNlbGYuZmwpDQogICAgICAgIG9zLnJlbW92ZShzZWxmLmFwaykNCiAgICAgICAgZXhpdCgpDQogICAgICAgIGJyZWFrDQogIGRlZiBicnV0ZVJlcXVlc3Qoc2VsZiwgdXNlcm5hbWUsIHBhc3N3b3JkKToNCiAgICBnbG9iYWwgb2ssY3AsdHRsDQogICAgcGFyYW1zID0geyJhY2Nlc3NfdG9rZW4iOiAiMzUwNjg1NTMxNzI4JTdDNjJmOGNlOWY3NGIxMmY4NGMxMjNjYzIzNDM3YTRhMzIiLCAgImZvcm1hdCI6ICJKU09OIiwgInNka192ZXJzaW9uIjogIjIiLCAiZW1haWwiOiB1c2VybmFtZSwgImxvY2FsZSI6ICJlbl9VUyIsICJwYXNzd29yZCI6IHBhc3N3b3JkLCAic2RrIjogImlvcyIsICJnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXMiOiAiMSIsICJzaWciOiAiM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYifQ0KICAgIGFwaSA9ICJodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbiINCiAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChhcGksIHBhcmFtcz1wYXJhbXMpDQogICAgaWYgcmUuc2VhcmNoKCIoRUFBQSlcXHcrIiwgcmVzcG9uc2UudGV4dCk6DQogICAgICBzZWxmLm9rLmFwcGVuZCh1c2VybmFtZSArICIg4oCiICIgKyBwYXNzd29yZCkNCiAgICAgIHByaW50KCgiXHJceDFiWzA7MzJtW1x4MWJbMDszN21PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAlcyAgICAgICAgICAgICAgICIlKHVzZXJuYW1lLHBhc3N3b3JkLE4pKSkNCiAgICAgIG9rLmFwcGVuZCh1c2VybmFtZSArICIg4oCiICIgKyBwYXNzd29yZCkNCiAgICAgIHNhdmUgPSBvcGVuKCJvay50eHQiLCAiYSIpDQogICAgICBzYXZlLndyaXRlKHN0cih1c2VybmFtZSkgKyAiIOKAoiAiICsgc3RyKHBhc3N3b3JkKSArICJcbiIpDQogICAgICBzYXZlLmNsb3NlKCkNCiAgICAgIHJldHVybiBUcnVlDQogICAgZWxzZToNCiAgICAgIGlmICJ3d3cuZmFjZWJvb2suY29tIiBpbiByZXNwb25zZS5qc29uKClbImVycm9yX21zZyJdOg0KICAgICAgICBzZWxmLmNwLmFwcGVuZCh1c2VybmFtZSArICIg4oCiICIgKyBwYXNzd29yZCkNCiAgICAgICAgcHJpbnQoKCJcclx4MWJbMDszM21bXHgxYlswOzM3bUNQXHgxYlswOzMzbV0gJXMg4oCiICVzICVzICAgICAgICAgICAgICAgIiUodXNlcm5hbWUscGFzc3dvcmQsTikpKQ0KICAgICAgICBzYXZlID0gb3BlbigiY3AudHh0IiwgImErIikNCiAgICAgICAgc2F2ZS53cml0ZShzdHIodXNlcm5hbWUpICsgIiDigKIgIiArIHN0cihwYXNzd29yZCkgKyAiXG4iKQ0KICAgICAgICBzYXZlLmNsb3NlKCkNCiAgICAgICAgcmV0dXJuIFRydWUNCiAgICByZXR1cm4gRmFsc2UNCiAgZGVmIGJydXRlKHNlbGYsIGZsKToNCiAgICBpZiBzZWxmLnNldHB3ID09IEZhbHNlOg0KICAgICAgc2VsZi5sb29wICs9IDENCiAgICAgIGZvciBwdyBpbiBmbFsicHciXToNCiAgICAgICAgdXNlcm5hbWUgPSBmbFsiaWQiXS5sb3dlcigpDQogICAgICAgIHBhc3N3b3JkID0gcHcubG93ZXIoKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgaWYgc2VsZi5icnV0ZVJlcXVlc3QodXNlcm5hbWUsIHBhc3N3b3JkKSA9PSBUcnVlOg0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIHByaW50KCgiXHJceDFiWzA7MzdtW0NyYWNrXSAlcy8lcyB8IE9LIDogJXMgfCBDUCA6ICVzIiUoc2VsZi5sb29wLGxlbihzZWxmLmZsKSxsZW4oc2VsZi5vayksbGVuKHNlbGYuY3ApKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIGVsc2U6DQogICAgICBzZWxmLmxvb3AgKz0gMQ0KICAgICAgZm9yIHB3IGluIHNlbGYuc2V0cHc6DQogICAgICAgIHVzZXJuYW1lID0gdXNlcnNbImlkIl0ubG93ZXIoKQ0KICAgICAgICBwYXNzd29yZCA9IHB3Lmxvd2VyKCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgIGlmIHNlbGYuYnJ1dGVSZXF1ZXN0KHVzZXJuYW1lLCBwYXNzd29yZCkgPT0gVHJ1ZToNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBwcmludCgoIlxyXHgxYlswOzM3bVtDcmFja10gJXMvJXMgfCBPSyA6ICVzIHwgQ1AgOiAlcyIlKHNlbGYubG9vcCxsZW4oc2VsZi5mbCksbGVuKHNlbGYub2spLGxlbihzZWxmLmNwKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCg0KY2xhc3MgYmFwaXR0bDoNCiAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgIHNlbGYuc2V0cHcgPSBGYWxzZQ0KICAgIHNlbGYub2sgPSBbXQ0KICAgIHNlbGYuY3AgPSBbXQ0KICAgIHNlbGYubG9vcCA9IDANCiAgICBzZWxmLmtyYWgoKQ0KICBkZWYga3JhaChzZWxmKToNCiAgICBwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBXaXRoIFBhc3MgRGVmYXVsdC9NYW51YWwgW2QvbV0iKSkNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgZj1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBDaG9vc2UgOiAiKQ0KICAgICAgaWYgZiBpblsiIiwiICJdOg0KICAgICAgICBwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIEludmFsaWQgTnVtYmVyIikpDQogICAgICAgIGNvbnRpbnVlDQogICAgICBlbGlmIGYgaW5bIm0iLCJNIl06DQogICAgICAgIHRyeToNCiAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICBzZWxmLmFwaz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBJRCBMaXN0IEZpbGUgOiAiKQ0KICAgICAgICAgICAgICBzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICAgcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiAlcyIlZSkpDQogICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgc2VsZi5mbD1bXQ0KICAgICAgICAgIHByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFeGFtcGxlIDogc2F5YW5nLGJpc21pbGxhaCwxMjM0NTYiKSkNCiAgICAgICAgICBzZWxmLnB3PWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFBhc3N3b3JkIExpc3QgOiAiKS5zcGxpdCgiLCIpDQogICAgICAgICAgaWYgbGVuKHNlbGYucHcpID09MDoNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpzZWxmLnB3fSkNCiAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgIHByaW50KCgiICAlcyIlZSkpDQogICAgICAgICAgY29udGludWUNCiAgICAgICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZC4uLiIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtPS10gU2F2ZWQgdG8gOiBvay50eHQiK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbQ1BdIFNhdmVkIHRvIDogY3AudHh0XG4iKSkNCiAgICAgICAgVGhyZWFkUG9vbCgzMCkubWFwKHNlbGYuYnJ1dGUsc2VsZi5mbCkNCiAgICAgICAgI29zLnJlbW92ZShzZWxmLmFwaykNCiAgICAgICAgZXhpdCgpDQogICAgICAgIGJyZWFrDQogICAgICBlbGlmIGYgaW5bImQiLCJEIl06DQogICAgICAgIHRyeToNCiAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICBzZWxmLmFwaz1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBJRCBMaXN0IEZpbGUgOiAiKQ0KICAgICAgICAgICAgICBzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICAgcHJpbnQoZSkNCiAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICBzZWxmLmZsPVtdDQogICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpnZW5lcmF0ZShpLnNwbGl0KCI8PT4iKVsxXSl9KQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLi4uIitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW09LXSBTYXZlZCB0byA6IG9rLnR4dCIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtDUF0gU2F2ZWQgdG8gOiBjcC50eHRcbiIpKQ0KICAgICAgICBUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5icnV0ZSxzZWxmLmZsKQ0KICAgICAgICBvcy5yZW1vdmUoc2VsZi5hcGspDQogICAgICAgIGV4aXQoKQ0KICAgICAgICBicmVhaw0KICBkZWYgYnJ1dGVSZXF1ZXN0KHNlbGYsIHVzZXJuYW1lLCBwYXNzd29yZCk6DQogICAgZ2xvYmFsIG9rLGNwLHR0bA0KICAgIHBhcmFtcyA9IHsiYWNjZXNzX3Rva2VuIjogIjM1MDY4NTUzMTcyOCU3QzYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyIiwgICJmb3JtYXQiOiAiSlNPTiIsICJzZGtfdmVyc2lvbiI6ICIyIiwgImVtYWlsIjogdXNlcm5hbWUsICJsb2NhbGUiOiAiZW5fVVMiLCAicGFzc3dvcmQiOiBwYXNzd29yZCwgInNkayI6ICJpb3MiLCAiZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzIjogIjEiLCAic2lnIjogIjNmNTU1Zjk5ZmI2MWZjZDdhYTBjNDRmNThmNTIyZWY2In0NCiAgICBhcGkgPSAiaHR0cHM6Ly9iLWFwaS5mYWNlYm9vay5jb20vbWV0aG9kL2F1dGgubG9naW4iDQogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoYXBpLCBwYXJhbXM9cGFyYW1zKQ0KICAgIGlmIHJlLnNlYXJjaCgiKEVBQUEpXFx3KyIsIHJlc3BvbnNlLnRleHQpOg0KICAgICAgc2VsZi5vay5hcHBlbmQodXNlcm5hbWUgKyAiIOKAoiAiICsgcGFzc3dvcmQpDQogICAgICBwcmludCgoIlxyXHgxYlswOzMybVtceDFiWzA7MzdtT0tceDFiWzA7MzJtXSAlcyDigKIgJXMgJXMgICAgICAgICAgICAgICAiJSh1c2VybmFtZSxwYXNzd29yZCxOKSkpDQogICAgICBvay5hcHBlbmQodXNlcm5hbWUgKyAiIOKAoiAiICsgcGFzc3dvcmQpDQogICAgICBzYXZlID0gb3Blbigib2sudHh0IiwgImEiKQ0KICAgICAgc2F2ZS53cml0ZShzdHIodXNlcm5hbWUpICsgIiDigKIgIiArIHN0cihwYXNzd29yZCkgKyAiXG4iKQ0KICAgICAgc2F2ZS5jbG9zZSgpDQogICAgICByZXR1cm4gVHJ1ZQ0KICAgIGVsc2U6DQogICAgICBpZiAid3d3LmZhY2Vib29rLmNvbSIgaW4gcmVzcG9uc2UuanNvbigpWyJlcnJvcl9tc2ciXToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgIGtlPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitzdHIodXNlcm5hbWUpKyI/YWNjZXNzX3Rva2VuPSIrb3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKSkNCiAgICAgICAgICB0dD1qc29uLmxvYWRzKGtlLnRleHQpDQogICAgICAgICAgdHRsPXR0WyJiaXJ0aGRheSJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHNlbGYuY3AuYXBwZW5kKHVzZXJuYW1lICsgIiDigKIgIiArIHBhc3N3b3JkICsgIiDigKIgIiArIHR0bCkNCiAgICAgICAgcHJpbnQoKCJcclx4MWJbMDszM21bXHgxYlswOzM3bUNQXHgxYlswOzMzbV0gJXMg4oCiICVzIOKAoiAlc1x4MWJbMG0gICAiJSh1c2VybmFtZSxwYXNzd29yZCx0dGwpKSkNCiAgICAgICAgc2F2ZSA9IG9wZW4oImNwLnR4dCIsICJhKyIpDQogICAgICAgIHNhdmUud3JpdGUoc3RyKHVzZXJuYW1lKSArICIg4oCiICIgKyBzdHIocGFzc3dvcmQpICsgIiDigKIgIisgc3RyKHR0bCkrIlxuIikNCiAgICAgICAgc2F2ZS5jbG9zZSgpDQogICAgICAgIHJldHVybiBUcnVlDQogICAgcmV0dXJuIEZhbHNlDQogIGRlZiBicnV0ZShzZWxmLCBmbCk6DQogICAgaWYgc2VsZi5zZXRwdyA9PSBGYWxzZToNCiAgICAgIHNlbGYubG9vcCArPSAxDQogICAgICBmb3IgcHcgaW4gZmxbInB3Il06DQogICAgICAgIHVzZXJuYW1lID0gZmxbImlkIl0ubG93ZXIoKQ0KICAgICAgICBwYXNzd29yZCA9IHB3Lmxvd2VyKCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgIGlmIHNlbGYuYnJ1dGVSZXF1ZXN0KHVzZXJuYW1lLCBwYXNzd29yZCkgPT0gVHJ1ZToNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBwcmludCgoIlxyXHgxYlswOzM3bVtDcmFja10gJXMvJXMgfCBPSyA6ICVzIHwgQ1AgOiAlcyIlKHNlbGYubG9vcCxsZW4oc2VsZi5mbCksbGVuKHNlbGYub2spLGxlbihzZWxmLmNwKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICBlbHNlOg0KICAgICAgc2VsZi5sb29wICs9IDENCiAgICAgIGZvciBwdyBpbiBzZWxmLnNldHB3Og0KICAgICAgICB1c2VybmFtZSA9IHVzZXJzWyJpZCJdLmxvd2VyKCkNCiAgICAgICAgcGFzc3dvcmQgPSBwdy5sb3dlcigpDQogICAgICAgIHRyeToNCiAgICAgICAgICBpZiBzZWxmLmJydXRlUmVxdWVzdCh1c2VybmFtZSwgcGFzc3dvcmQpID09IFRydWU6DQogICAgICAgICAgICBicmVhaw0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgY29udGludWUNCiAgICAgICAgcHJpbnQoKCJcclx4MWJbMDszN21bQ3JhY2tdICVzLyVzIHwgT0sgOiAlcyB8IENQIDogJXMiJShzZWxmLmxvb3AsbGVuKHNlbGYuZmwpLGxlbihzZWxmLm9rKSxsZW4oc2VsZi5jcCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQoNCiMjIyBSRVNVTFQgIyMjDQoNCmRlZiByZXN1bHRzKGFzaW0sS3JhaGtyYWgpOg0KICAgICAgICBpZiBsZW4oYXNpbSkgIT0wOg0KICAgICAgICAgICAgICAgIHByaW50KCgiW09LXSA6ICIrc3RyKGxlbihhc2ltKSkpKQ0KICAgICAgICBpZiBsZW4oS3JhaGtyYWgpICE9MDoNCiAgICAgICAgICAgICAgICBwcmludCgoIltDUF0gOiAiK3N0cihsZW4oS3JhaGtyYWgpKSkpDQogICAgICAgIGlmIGxlbihhc2ltKSA9PTAgYW5kIGxlbihLcmFoa3JhaCkgPT0wOg0KICAgICAgICAgICAgICAgIHByaW50KCJcbiIpDQogICAgICAgICAgICAgICAgcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBObyBSZXN1bHQgRm91bmQiKSkNCg0KZGVmIHJlc3MoKToNCiAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBiYW5uZXIoKQ0KICAgIHByaW50KChrKyJcblsgIitwKyJSZXN1bHQgQ3JhY2siK2srIiBdIitwKSkNCiAgICBwcmludCgoaysiXG5bICIrcCsiT0siK2srIiBdIitwKSkNCiAgICB0cnk6DQogICAgICAgIG9zLnN5c3RlbSgiY2F0IG9rLnR4dCIpDQogICAgZXhjZXB0IElPRXJyb3I6DQogICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgTm8gUmVzdWx0IEZvdW5kIikpDQogICAgcHJpbnQoKGsrIlxuWyAiK3ArIkNQIitrKyIgXSIrcCkpDQogICAgdHJ5Og0KICAgICAgICBvcy5zeXN0ZW0oImNhdCBjcC50eHQiKQ0KICAgIGV4Y2VwdCBJT0Vycm9yOg0KICAgICAgICBwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIE5vIFJlc3VsdCBGb3VuZCIpKQ0KICAgIGlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQ0KICAgIG1lbnUoKQ0KDQpkZWYgdXBkYXRlc2MoKToNCglvcy5zeXN0ZW0oImNsZWFyIikNCgliYW5uZXIoKQ0KCXByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIFVwZGF0aW5nIFNjcmlwdCIpKQ0KCW9zLnN5c3RlbSgiZ2l0IHB1bGwgb3JpZ2luIG1hc3RlciIpDQoJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVXBkYXRlIFN1Y2Nlc3NmdWwiKSkNCglleGl0KCkNCg0KZGVmIHdhbmdzYWZmKCk6DQogICAgb3Muc3lzdGVtKCJjbGVhciIpDQogICAgYmFubmVyKCkNCiAgICBpbnB1dCgiXG5bIENvbnRhY3QgTWFyaz8gXSIpDQogICAgamFsYW4oaysiWyIrcCsi4oCiIitrKyJdIitwKyIgT3BlbiBXaGF0c2FwcC4uLiIpDQogICAgb3Muc3lzdGVtKCJ4ZGctb3BlbiBodHRwczovL3dhLm1lLysyMzQ3MDEzMTA3NDQ5P3RleHQ9R1JFRVRJTkdTJTIwQlJPLCUyMFRvb2wlMjBOb3QlMjBXb3JraW5nJTIwQnJvJTIwTWFyay4lMjBDb2RlOiUyMDQwNCIpDQogICAgaW5wdXQoaysiXG5bICIrcCsiQmFjayIraysiIF0iK3ApDQogICAgbWVudSgpDQoNCmlmIF9fbmFtZV9fPT0iX19tYWluX18iOg0KCW1lbnUoKQ=="))